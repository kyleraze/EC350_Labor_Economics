"0","options(htmltools.dir.version = FALSE)"
"0","library(pacman)"
"0","p_load(ggthemes, readxl, viridis, knitr, dslabs, gapminder, extrafont, Ecdat, wooldridge, tidyverse, magrittr, janitor, kableExtra)"
"0","# Define colors"
"0","red_pink <- ""#e64173"""
"0","met_slate <- ""#272822"" # metropolis font color "
"0","purple <- ""#9370DB"""
"0","green <- ""#007935"""
"0","light_green <- ""#7DBA97"""
"0","orange <- ""#FD5F00"""
"0","turquoise <- ""#44C1C4"""
"0","# Notes directory"
"0","dir_slides <- ""~/GitHub/Intro_Labor_S21/Lectures/05-Workers/"""
"0","# Knitr options"
"0","opts_chunk$set("
"0","  comment = ""#>"","
"0","  fig.align = ""center"","
"0","  fig.height = 7,"
"0","  fig.width = 10.5,"
"0","  #dpi = 300,"
"0","  #cache = T,"
"0","  warning = F,"
"0","  message = F"
"0",")  "
"0","theme_simple <- theme_bw() + theme("
"0","  axis.line = element_line(color = met_slate),"
"0","  panel.grid = element_blank(),"
"0","  rect = element_blank(),"
"0","  strip.text = element_blank(),"
"0","  text = element_text(family = ""Fira Sans"", color = met_slate, size = 17),"
"0","  axis.text.x = element_text(size = 12),"
"0","  axis.text.y = element_text(size = 12),"
"0","  axis.ticks = element_blank()"
"0",")"
"0","theme_market <- theme_bw() + theme("
"0","  axis.line = element_line(color = met_slate),"
"0","  panel.grid = element_blank(),"
"0","  rect = element_blank(),"
"0","  strip.text = element_blank(),"
"0","  text = element_text(family = ""Fira Sans"", color = met_slate, size = 17),"
"0","  axis.title.x = element_text(hjust = 1, size = 17),"
"0","  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),"
"0","  # axis.text.x = element_text(size = 12),"
"0","  # axis.text.y = element_text(size = 12),"
"0","  axis.ticks = element_blank()"
"0",")"
"0","theme_gif <- theme_bw() + theme("
"0","  axis.line = element_line(color = met_slate),"
"0","  panel.grid = element_blank(),"
"0","  rect = element_blank(),"
"0","  text = element_text(family = ""Fira Sans"", color = met_slate, size = 17),"
"0","  axis.text.x = element_text(size = 12),"
"0","  axis.text.y = element_text(size = 12),"
"0","  axis.ticks = element_blank()"
"0",")"
"0","wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = ""\n"")"
"0",""
"0","# budget line (for graphing)"
"0","budget <- function(x, wage, non_labor_income) {"
"0","  wage * (24 - x) + non_labor_income"
"0","}"
"0",""
"0","# utility function = u(x, y) = C (x - A)^a (y - B)^(1-a)"
"0","utility <- function(x, y, constant = 1, alpha = 0.5, offset = 10) {"
"0","  if (offset == 0) {"
"0","    utility <- constant * (x ^ alpha) * (y ^ (1 - alpha))"
"0","  } else {"
"0","    utility <-"
"0","      constant * ((x - 1 / offset) ^ alpha) * ((y - 1 / offset) ^ (1 - alpha))"
"0","  }"
"0","  return(utility)"
"0","}"
"0",""
"0","# optimal leisure hours"
"0","optimize <-"
"0","  function(non_labor_income = 0,"
"0","           wage = 4,"
"0","           alpha = 0.5,"
"0","           offset = 10) {"
"0","    if (offset == 0) {"
"0","      marginal_utility <-"
"0","        function(x) {"
"0","          ((1 - alpha) / alpha) * wage * x"
"0","        }"
"0","    } else {"
"0","      marginal_utility <- function(x) {"
"0","        (offset * x * wage + wage - alpha * (offset * x * wage + wage + 1)) / (offset * alpha)"
"0","      }"
"0","    }"
"0","    "
"0","    budget <- function(x) {"
"0","      wage * (24 - x) + non_labor_income"
"0","    }"
"0","    "
"0","    optimal_x <-"
"0","      uniroot(function(x)"
"0","        budget(x) - marginal_utility(x), c(-100, 100))$root"
"0","    "
"0","    if (optimal_x > 24) {"
"0","      optimal_x <- 24"
"0","    }"
"0","    "
"0","    return(optimal_x)"
"0","  }"
"0",""
"0","# indifference curve (k = utility level)"
"0","ic <- function(x, k, constant = 1, alpha = 0.5, offset = 10) {"
"0","  if (offset == 0) {"
"0","    ic <- (k / (constant * x ^ alpha)) ^ (1 / (1 - alpha))"
"0","  } else {"
"0","    ic <- ((k * (x - 1/offset) ^ (-alpha)) / constant) ^ (1 / (1 - alpha)) + 1/offset"
"0","  }"
"0","  return(ic)"
"0","}"
"0",""
"0","# not accurate enough for offset != 0"
"0","ic_slope <- function(x, k, constant = 1, alpha = 0.5, offset = 10) {"
"0","  if (offset == 0) {"
"0","    ic_slope <- alpha * ((k * x ^ (-alpha)) / constant) ^ (1 / (1 - alpha)) / ((alpha - 1) * x)"
"0","  } else {"
"0","    ic_slope <- alpha * offset * ((k * (x - 1/offset) ^ (-alpha)) / constant) ^ (1 / (1 - alpha)) / ((alpha - 1) * (offset * x - 1))"
"0","  }"
"0","  return(ic_slope)"
"0","}"
